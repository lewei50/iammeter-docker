(self.webpackChunkclient=self.webpackChunkclient||[]).push([[946],{8946:function(t,e,i){"use strict";i.r(e),i.d(e,{ExtensionModule:function(){return K}});var a=i(56036),o=i(63423),s=i(10250),l=i(3679),n=i(22238),r=i(37716),c=i(49344),d=i(29790),p=i(85557),u=i(76627),m=i(38583),f=i(35618),h=i(98295),g=i(58308),Z=i(83166),x=i(7539),A=i(51095);function b(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"validations.required"),""))}function v(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"validations.required"),""))}function T(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"validations.required"),""))}function q(t,e){if(1&t&&(r.TgZ(0,"form",3),r.TgZ(1,"div",4),r.TgZ(2,"div",5),r.TgZ(3,"mat-form-field"),r.TgZ(4,"mat-label"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r._UZ(7,"mtx-select",6),r.YNc(8,b,3,3,"mat-error",2),r.qZA(),r.qZA(),r.TgZ(9,"div",5),r.TgZ(10,"mat-form-field"),r.TgZ(11,"mat-label"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r._UZ(14,"input",7),r.ALo(15,"translate"),r.YNc(16,v,3,3,"mat-error",2),r.qZA(),r.qZA(),r.TgZ(17,"div",5),r.TgZ(18,"mat-form-field"),r.TgZ(19,"mat-label"),r._uU(20),r.ALo(21,"translate"),r.qZA(),r._UZ(22,"input",8),r.ALo(23,"translate"),r.YNc(24,T,3,3,"mat-error",2),r.qZA(),r.qZA(),r.TgZ(25,"div",5),r.TgZ(26,"mat-checkbox",9),r._uU(27),r.ALo(28,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t){const t=r.oxw();r.Q6J("formGroup",t.form1),r.xp6(5),r.Oqu(r.lcZ(6,11,"bll.place-name")),r.xp6(2),r.Q6J("items",t.places),r.xp6(1),r.Q6J("ngIf",t.form1.get("placeId").invalid),r.xp6(4),r.Oqu(r.lcZ(13,13,"extension.api-key")),r.xp6(2),r.Q6J("placeholder",r.lcZ(15,15,"extension.api-key")),r.xp6(2),r.Q6J("ngIf",t.form1.get("apiKey").invalid),r.xp6(4),r.Oqu(r.lcZ(21,17,"extension.system-id")),r.xp6(2),r.Q6J("placeholder",r.lcZ(23,19,"extension.system-id")),r.xp6(2),r.Q6J("ngIf",t.form1.get("deviceId").invalid),r.xp6(3),r.hij("",r.lcZ(28,21,"extension.is-active")," ")}}function _(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"mat-dialog-actions"),r.TgZ(1,"button",10),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"button",11),r.NdJ("click",function(){return r.CHM(t),r.oxw().save()}),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA()}if(2&t){const t=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,3,"common.close")),r.xp6(2),r.Q6J("disabled",t.form1.invalid),r.xp6(1),r.Oqu(r.lcZ(6,5,"common.save"))}}let y=(()=>{class t{constructor(t,e,i,a,o,s){this.dialogRef=t,this.toastr=e,this.fb=i,this.translate=a,this._api=o,this.data=s,this.places=this._api.place_placelist().subscribe(t=>{this.places=t.data,this.form1=this.fb.group({id:[null],type:["pvoutput"],placeId:[null,[l.kI.required]],isActive:[!0],apiKey:[""],deviceId:[""]}),this.form1.patchValue(this.data)})}ngOnInit(){console.log(this.places)}onClose(){this.dialogRef.close()}save(){console.log(this.data.id),this._api.extension_save(this.data.id,this.form1.getRawValue()).subscribe(t=>{!0===t.successful&&this.toastr.success(t.message),this.dialogRef.close(!0)})}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(n.so),r.Y36(c._W),r.Y36(l.qu),r.Y36(d.sK),r.Y36(p.t),r.Y36(n.WI))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-extension-pvoutput-edit"]],decls:8,vars:6,consts:[["mat-dialog-title",""],["class","form-field-full",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"form-field-full",3,"formGroup"],["fxLayout","row wrap","fxLayoutGap","8px grid"],["fxFlex","100","fxFlex.lt-sm","100"],["bindLabel","name","bindValue","id","formControlName","placeId",3,"items"],["matInput","","type","text","formControlName","apiKey","required","",3,"placeholder"],["matInput","","type","text","formControlName","deviceId","required","",3,"placeholder"],["formControlName","isActive"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"disabled","click"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-icon"),r._uU(2),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"mat-dialog-content"),r.YNc(6,q,29,23,"form",1),r.qZA(),r.YNc(7,_,7,7,"mat-dialog-actions",2)),2&t&&(r.xp6(2),r.Oqu("00000000-0000-0000-0000-000000000000"!=e.data.id?"edit":"add"),r.xp6(1),r.hij(" ",r.lcZ(4,4,"00000000-0000-0000-0000-000000000000"!=e.data.id?"extension.edit":"extension.add")," "),r.xp6(3),r.Q6J("ngIf",null!=e.form1),r.xp6(1),r.Q6J("ngIf",e.form1))},directives:[n.uh,u.Hw,n.xY,m.O5,l._Y,l.JL,l.sg,f.xw,f.SQ,f.yH,h.KE,h.hX,g.MS,l.JJ,l.u,Z.Nt,l.Fj,l.Q7,x.oG,h.TO,n.H8,A.lW,n.ZT],pipes:[d.X$],styles:[".mat-dialog-content[_ngcontent-%COMP%]{overflow:auto;max-height:none;display:inherit}"]}),t})();var w=i(99603),I=i(32802),Y=i(63887);const J=["isActiveTpl"];function L(t,e){1&t&&(r.TgZ(0,"mat-icon",7),r._uU(1,"check"),r.qZA())}function k(t,e){1&t&&(r.TgZ(0,"mat-icon",8),r._uU(1,"close"),r.qZA())}function U(t,e){if(1&t&&(r.YNc(0,L,2,0,"mat-icon",5),r.YNc(1,k,2,0,"mat-icon",6)),2&t){const t=e.$implicit;r.Q6J("ngIf",1==t.isActive),r.xp6(1),r.Q6J("ngIf",0==t.isActive)}}let N=(()=>{class t{constructor(t,e,i,a,o,s){this.toastr=t,this.cdr=e,this._api=i,this.dialog=a,this._translate=o,this._router=s,this.columns=[],this.list=[],this.isLoading=!1}ngOnInit(){this.columns=[{header:this._translate.stream("bll.place-name"),field:"placeName",sortable:!0},{header:this._translate.stream("extension.api-key"),field:"apiKey",sortable:!0},{header:this._translate.stream("extension.system-id"),field:"deviceId",sortable:!0},{header:this._translate.stream("extension.is-active"),field:"isActive",cellTemplate:this.isActiveTpl},{header:this._translate.stream("common.operation"),field:"option",width:"180px",pinned:"right",right:"0px",type:"button",buttons:[{icon:"pageview",tooltip:"View",type:"icon",click:t=>window.open("https://pvoutput.org/list.jsp?sid="+t.deviceId)},{icon:"edit",tooltip:"Edit",type:"icon",click:t=>this.edit(t)},{icon:"delete",tooltip:"Delete",color:"warn",type:"icon",pop:!0,popTitle:"Confirm delete?",click:t=>this.delete(t)}]}],this.loadData()}loadData(){this.isLoading=!0,this._api.extension_list("pvoutput").subscribe(t=>{this.list=t.data,this.isLoading=!1,this.cdr.markForCheck(),this.cdr.detectChanges()})}edit(t){this.openDialog(t)}openDialog(t){this.dialog.originalOpen(y,{width:"600px",data:t}).afterClosed().subscribe(t=>{!0===t&&this.loadData()})}add(){this.openDialog({id:s.i.createEmpty(),type:"pvoutput",isActive:!0})}delete(t){this._api.extension_delete(t.id).subscribe(t=>{!0===t.successful&&this.toastr.success(t.message),this.loadData()})}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(c._W),r.Y36(r.sBO),r.Y36(p.t),r.Y36(w.cP),r.Y36(d.sK),r.Y36(o.F0))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-extension-pvoutput"]],viewQuery:function(t,e){if(1&t&&r.Gf(J,7),2&t){let t;r.iGM(t=r.CRH())&&(e.isActiveTpl=t.first)}},decls:10,vars:9,consts:[["mat-button","",3,"click"],["aria-label","add"],["aria-label","refresh"],[3,"data","columns","loading","multiSelectable","rowSelectable","showPaginator","toolbarTitle","rowStriped","showToolbar"],["isActiveTpl",""],["style","color:green;",4,"ngIf"],["style","color:red;",4,"ngIf"],[2,"color","green"],[2,"color","red"]],template:function(t,e){1&t&&(r.TgZ(0,"page-header"),r.TgZ(1,"button",0),r.NdJ("click",function(){return e.add()}),r.TgZ(2,"mat-icon",1),r._uU(3,"add"),r.qZA(),r.qZA(),r.TgZ(4,"button",0),r.NdJ("click",function(){return e.loadData()}),r.TgZ(5,"mat-icon",2),r._uU(6,"refresh"),r.qZA(),r.qZA(),r.qZA(),r._UZ(7,"mtx-grid",3),r.YNc(8,U,2,2,"ng-template",null,4,r.W1O)),2&t&&(r.xp6(7),r.Q6J("data",e.list)("columns",e.columns)("loading",e.isLoading)("multiSelectable",!0)("rowSelectable",!1)("showPaginator",!1)("toolbarTitle","Place list")("rowStriped",!0)("showToolbar",!1))},directives:[I.q,A.lW,u.Hw,Y.CM,m.O5],styles:[""]}),t})();var O=i(81057);function Q(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"validations.required"),""))}function C(t,e){if(1&t&&(r.TgZ(0,"form",3),r.TgZ(1,"div",4),r.TgZ(2,"div",5),r.TgZ(3,"mat-form-field"),r.TgZ(4,"mat-label"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r._UZ(7,"input",6),r.ALo(8,"translate"),r.YNc(9,Q,3,3,"mat-error",2),r.qZA(),r.qZA(),r.TgZ(10,"div",5),r.TgZ(11,"mat-form-field"),r.TgZ(12,"mat-label"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r._UZ(15,"mtx-select",7),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t){const t=r.oxw();r.Q6J("formGroup",t.form1),r.xp6(5),r.Oqu(r.lcZ(6,6,"common.ipaddress")),r.xp6(2),r.Q6J("placeholder",r.lcZ(8,8,"common.ipaddress")),r.xp6(2),r.Q6J("ngIf",t.form1.get("ipAddress").invalid),r.xp6(4),r.Oqu(r.lcZ(14,10,"bll.meter.type")),r.xp6(2),r.Q6J("items",t.types)}}function S(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"mat-dialog-actions"),r.TgZ(1,"button",8),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"button",9),r.NdJ("click",function(){return r.CHM(t),r.oxw().save()}),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA()}if(2&t){const t=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,3,"common.close")),r.xp6(2),r.Q6J("disabled",t.form1.invalid),r.xp6(1),r.Oqu(r.lcZ(6,5,"common.save"))}}let D=(()=>{class t{constructor(t,e,i,a,o,s,l){this.dialogRef=t,this.toastr=e,this.fb=i,this.translate=a,this._classCodeService=o,this._api=s,this.data=l,this.types=o.getMeterType(),this.form1=this.fb.group({id:[null],typeId:[""],ipAddress:[""],deviceId:[""]}),this.form1.patchValue(this.data)}ngOnInit(){}onClose(){this.dialogRef.close()}save(){console.log(this.data.id),this._api.datalog_save(this.data.id,this.form1.getRawValue()).subscribe(t=>{!0===t.successful&&this.toastr.success(t.message),this.dialogRef.close(!0)})}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(n.so),r.Y36(c._W),r.Y36(l.qu),r.Y36(d.sK),r.Y36(O.I),r.Y36(p.t),r.Y36(n.WI))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-extension-pvoutput-edit"]],decls:8,vars:6,consts:[["mat-dialog-title",""],["class","form-field-full",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"form-field-full",3,"formGroup"],["fxLayout","row wrap","fxLayoutGap","8px grid"],["fxFlex","50","fxFlex.lt-sm","100"],["matInput","","type","text","formControlName","ipAddress","required","",3,"placeholder"],["bindLabel","name","bindValue","key","formControlName","typeId",3,"items"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"disabled","click"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-icon"),r._uU(2),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"mat-dialog-content"),r.YNc(6,C,16,12,"form",1),r.qZA(),r.YNc(7,S,7,7,"mat-dialog-actions",2)),2&t&&(r.xp6(2),r.Oqu("00000000-0000-0000-0000-000000000000"!=e.data.id?"edit":"add"),r.xp6(1),r.hij(" ",r.lcZ(4,4,"00000000-0000-0000-0000-000000000000"!=e.data.id?"datalog.edit":"datalog.add")," "),r.xp6(3),r.Q6J("ngIf",null!=e.form1),r.xp6(1),r.Q6J("ngIf",e.form1))},directives:[n.uh,u.Hw,n.xY,m.O5,l._Y,l.JL,l.sg,f.xw,f.SQ,f.yH,h.KE,h.hX,Z.Nt,l.Fj,l.JJ,l.u,l.Q7,g.MS,h.TO,n.H8,A.lW,n.ZT],pipes:[d.X$],styles:[".mat-dialog-content[_ngcontent-%COMP%]{overflow:auto;max-height:none;display:inherit}"]}),t})();const F=["isActiveTpl"];function G(t,e){1&t&&(r.TgZ(0,"mat-icon",7),r._uU(1,"check"),r.qZA())}function j(t,e){1&t&&(r.TgZ(0,"mat-icon",8),r._uU(1,"close"),r.qZA())}function H(t,e){if(1&t&&(r.YNc(0,G,2,0,"mat-icon",5),r.YNc(1,j,2,0,"mat-icon",6)),2&t){const t=e.$implicit;r.Q6J("ngIf",1==t.isActive),r.xp6(1),r.Q6J("ngIf",0==t.isActive)}}const M=[{path:"pvoutput",component:N},{path:"datalog",component:(()=>{class t{constructor(t,e,i,a,o,s){this.toastr=t,this.cdr=e,this._api=i,this.dialog=a,this._translate=o,this._router=s,this.columns=[],this.list=[],this.isLoading=!1}ngOnInit(){this.columns=[{header:this._translate.stream("common.ipaddress"),field:"ipAddress",sortable:!0},{header:this._translate.stream("bll.meter.type"),field:"typeId",sortable:!0,formatter:t=>this._translate.instant("bll.meter.type"+t.typeId)},{header:this._translate.stream("common.addtime"),field:"addTime",sortable:!0,formatter:t=>new Date(t.addTime).toLocaleString()},{header:this._translate.stream("common.operation"),field:"option",width:"180px",pinned:"right",right:"0px",type:"button",buttons:[{icon:"pageview",tooltip:"View",type:"icon",click:t=>window.open("/vue/#/datalog/"+t.ipAddress)},{icon:"edit",tooltip:"Edit",type:"icon",click:t=>this.edit(t)},{icon:"delete",tooltip:"Delete",color:"warn",type:"icon",pop:!0,popTitle:"Confirm delete?",click:t=>this.delete(t)}]}],this.loadData()}loadData(){this.isLoading=!0,this._api.datalog_list().subscribe(t=>{this.list=t.data,this.isLoading=!1,this.cdr.markForCheck(),this.cdr.detectChanges()})}edit(t){this.openDialog(t)}openDialog(t){this.dialog.originalOpen(D,{width:"600px",data:t}).afterClosed().subscribe(t=>{!0===t&&this.loadData()})}add(){this.openDialog({id:s.i.createEmpty(),typeId:1})}delete(t){this._api.datalog_delete(t.id).subscribe(t=>{!0===t.successful&&this.toastr.success(t.message),this.loadData()})}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(c._W),r.Y36(r.sBO),r.Y36(p.t),r.Y36(w.cP),r.Y36(d.sK),r.Y36(o.F0))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-extension-data"]],viewQuery:function(t,e){if(1&t&&r.Gf(F,7),2&t){let t;r.iGM(t=r.CRH())&&(e.isActiveTpl=t.first)}},decls:10,vars:9,consts:[["mat-button","",3,"click"],["aria-label","add"],["aria-label","refresh"],[3,"data","columns","loading","multiSelectable","rowSelectable","showPaginator","toolbarTitle","rowStriped","showToolbar"],["isActiveTpl",""],["style","color:green;",4,"ngIf"],["style","color:red;",4,"ngIf"],[2,"color","green"],[2,"color","red"]],template:function(t,e){1&t&&(r.TgZ(0,"page-header"),r.TgZ(1,"button",0),r.NdJ("click",function(){return e.add()}),r.TgZ(2,"mat-icon",1),r._uU(3,"add"),r.qZA(),r.qZA(),r.TgZ(4,"button",0),r.NdJ("click",function(){return e.loadData()}),r.TgZ(5,"mat-icon",2),r._uU(6,"refresh"),r.qZA(),r.qZA(),r.qZA(),r._UZ(7,"mtx-grid",3),r.YNc(8,H,2,2,"ng-template",null,4,r.W1O)),2&t&&(r.xp6(7),r.Q6J("data",e.list)("columns",e.columns)("loading",e.isLoading)("multiSelectable",!0)("rowSelectable",!1)("showPaginator",!1)("toolbarTitle","list")("rowStriped",!0)("showToolbar",!1))},directives:[I.q,A.lW,u.Hw,Y.CM,m.O5],styles:[""]}),t})()}];let W=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[o.Bz.forChild(M)],o.Bz]}),t})(),K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[a.m,W]]}),t})()}}]);