!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}(self.webpackChunkclient=self.webpackChunkclient||[]).push([[946],{8946:function(e,a,o){"use strict";o.r(a),o.d(a,{ExtensionModule:function(){return V}});var n=o(56036),l=o(63423),s=o(10250),r=o(3679),c=o(22238),d=o(37716),u=o(49344),p=o(29790),f=o(85557),m=o(76627),g=o(38583),h=o(35618),Z=o(98295),v=o(58308),x=o(83166),b=o(7539),A=o(51095);function y(t,e){1&t&&(d.TgZ(0,"mat-error"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"validations.required"),""))}function T(t,e){1&t&&(d.TgZ(0,"mat-error"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"validations.required"),""))}function q(t,e){1&t&&(d.TgZ(0,"mat-error"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"validations.required"),""))}function _(t,e){if(1&t&&(d.TgZ(0,"form",3),d.TgZ(1,"div",4),d.TgZ(2,"div",5),d.TgZ(3,"mat-form-field"),d.TgZ(4,"mat-label"),d._uU(5),d.ALo(6,"translate"),d.qZA(),d._UZ(7,"mtx-select",6),d.YNc(8,y,3,3,"mat-error",2),d.qZA(),d.qZA(),d.TgZ(9,"div",5),d.TgZ(10,"mat-form-field"),d.TgZ(11,"mat-label"),d._uU(12),d.ALo(13,"translate"),d.qZA(),d._UZ(14,"input",7),d.ALo(15,"translate"),d.YNc(16,T,3,3,"mat-error",2),d.qZA(),d.qZA(),d.TgZ(17,"div",5),d.TgZ(18,"mat-form-field"),d.TgZ(19,"mat-label"),d._uU(20),d.ALo(21,"translate"),d.qZA(),d._UZ(22,"input",8),d.ALo(23,"translate"),d.YNc(24,q,3,3,"mat-error",2),d.qZA(),d.qZA(),d.TgZ(25,"div",5),d.TgZ(26,"mat-checkbox",9),d._uU(27),d.ALo(28,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t){var i=d.oxw();d.Q6J("formGroup",i.form1),d.xp6(5),d.Oqu(d.lcZ(6,11,"bll.place-name")),d.xp6(2),d.Q6J("items",i.places),d.xp6(1),d.Q6J("ngIf",i.form1.get("placeId").invalid),d.xp6(4),d.Oqu(d.lcZ(13,13,"extension.api-key")),d.xp6(2),d.Q6J("placeholder",d.lcZ(15,15,"extension.api-key")),d.xp6(2),d.Q6J("ngIf",i.form1.get("apiKey").invalid),d.xp6(4),d.Oqu(d.lcZ(21,17,"extension.system-id")),d.xp6(2),d.Q6J("placeholder",d.lcZ(23,19,"extension.system-id")),d.xp6(2),d.Q6J("ngIf",i.form1.get("deviceId").invalid),d.xp6(3),d.hij("",d.lcZ(28,21,"extension.is-active")," ")}}function w(t,e){if(1&t){var i=d.EpF();d.TgZ(0,"mat-dialog-actions"),d.TgZ(1,"button",10),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"button",11),d.NdJ("click",function(){return d.CHM(i),d.oxw().save()}),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA()}if(2&t){var a=d.oxw();d.xp6(2),d.Oqu(d.lcZ(3,3,"common.close")),d.xp6(2),d.Q6J("disabled",a.form1.invalid),d.xp6(1),d.Oqu(d.lcZ(6,5,"common.save"))}}var k=function(){var e=function(){function e(i,a,o,n,l,s){var c=this;t(this,e),this.dialogRef=i,this.toastr=a,this.fb=o,this.translate=n,this._api=l,this.data=s,this.places=this._api.place_placelist().subscribe(function(t){c.places=t.data,c.form1=c.fb.group({id:[null],type:["pvoutput"],placeId:[null,[r.kI.required]],isActive:[!0],apiKey:[""],deviceId:[""]}),c.form1.patchValue(c.data)})}return i(e,[{key:"ngOnInit",value:function(){console.log(this.places)}},{key:"onClose",value:function(){this.dialogRef.close()}},{key:"save",value:function(){var t=this;console.log(this.data.id),this._api.extension_save(this.data.id,this.form1.getRawValue()).subscribe(function(e){!0===e.successful&&t.toastr.success(e.message),t.dialogRef.close(!0)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(c.so),d.Y36(u._W),d.Y36(r.qu),d.Y36(p.sK),d.Y36(f.t),d.Y36(c.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-extension-pvoutput-edit"]],decls:8,vars:6,consts:[["mat-dialog-title",""],["class","form-field-full",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"form-field-full",3,"formGroup"],["fxLayout","row wrap","fxLayoutGap","8px grid"],["fxFlex","100","fxFlex.lt-sm","100"],["bindLabel","name","bindValue","id","formControlName","placeId",3,"items"],["matInput","","type","text","formControlName","apiKey","required","",3,"placeholder"],["matInput","","type","text","formControlName","deviceId","required","",3,"placeholder"],["formControlName","isActive"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"disabled","click"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"mat-icon"),d._uU(2),d.qZA(),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"mat-dialog-content"),d.YNc(6,_,29,23,"form",1),d.qZA(),d.YNc(7,w,7,7,"mat-dialog-actions",2)),2&t&&(d.xp6(2),d.Oqu("00000000-0000-0000-0000-000000000000"!=e.data.id?"edit":"add"),d.xp6(1),d.hij(" ",d.lcZ(4,4,"00000000-0000-0000-0000-000000000000"!=e.data.id?"extension.edit":"extension.add")," "),d.xp6(3),d.Q6J("ngIf",null!=e.form1),d.xp6(1),d.Q6J("ngIf",e.form1))},directives:[c.uh,m.Hw,c.xY,g.O5,r._Y,r.JL,r.sg,h.xw,h.SQ,h.yH,Z.KE,Z.hX,v.MS,r.JJ,r.u,x.Nt,r.Fj,r.Q7,b.oG,Z.TO,c.H8,A.lW,c.ZT],pipes:[p.X$],styles:[".mat-dialog-content[_ngcontent-%COMP%]{overflow:auto;max-height:none;display:inherit}"]}),e}(),I=o(99603),Y=o(32802),J=o(63887),L=["isActiveTpl"];function U(t,e){1&t&&(d.TgZ(0,"mat-icon",7),d._uU(1,"check"),d.qZA())}function O(t,e){1&t&&(d.TgZ(0,"mat-icon",8),d._uU(1,"close"),d.qZA())}function C(t,e){if(1&t&&(d.YNc(0,U,2,0,"mat-icon",5),d.YNc(1,O,2,0,"mat-icon",6)),2&t){var i=e.$implicit;d.Q6J("ngIf",1==i.isActive),d.xp6(1),d.Q6J("ngIf",0==i.isActive)}}var N=function(){var e=function(){function e(i,a,o,n,l,s){t(this,e),this.toastr=i,this.cdr=a,this._api=o,this.dialog=n,this._translate=l,this._router=s,this.columns=[],this.list=[],this.isLoading=!1}return i(e,[{key:"ngOnInit",value:function(){var t=this;this.columns=[{header:this._translate.stream("bll.place-name"),field:"placeName",sortable:!0},{header:this._translate.stream("extension.api-key"),field:"apiKey",sortable:!0},{header:this._translate.stream("extension.system-id"),field:"deviceId",sortable:!0},{header:this._translate.stream("extension.is-active"),field:"isActive",cellTemplate:this.isActiveTpl},{header:this._translate.stream("common.operation"),field:"option",width:"180px",pinned:"right",right:"0px",type:"button",buttons:[{icon:"pageview",tooltip:"View",type:"icon",click:function(t){return window.open("https://pvoutput.org/list.jsp?sid="+t.deviceId)}},{icon:"edit",tooltip:"Edit",type:"icon",click:function(e){return t.edit(e)}},{icon:"delete",tooltip:"Delete",color:"warn",type:"icon",pop:!0,popTitle:"Confirm delete?",click:function(e){return t.delete(e)}}]}],this.loadData()}},{key:"loadData",value:function(){var t=this;this.isLoading=!0,this._api.extension_list("pvoutput").subscribe(function(e){t.list=e.data,t.isLoading=!1,t.cdr.markForCheck(),t.cdr.detectChanges()})}},{key:"edit",value:function(t){this.openDialog(t)}},{key:"openDialog",value:function(t){var e=this;this.dialog.originalOpen(k,{width:"600px",data:t}).afterClosed().subscribe(function(t){!0===t&&e.loadData()})}},{key:"add",value:function(){this.openDialog({id:s.i.createEmpty(),type:"pvoutput",isActive:!0})}},{key:"delete",value:function(t){var e=this;this._api.extension_delete(t.id).subscribe(function(t){!0===t.successful&&e.toastr.success(t.message),e.loadData()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(u._W),d.Y36(d.sBO),d.Y36(f.t),d.Y36(I.cP),d.Y36(p.sK),d.Y36(l.F0))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-extension-pvoutput"]],viewQuery:function(t,e){var i;(1&t&&d.Gf(L,7),2&t)&&(d.iGM(i=d.CRH())&&(e.isActiveTpl=i.first))},decls:10,vars:9,consts:[["mat-button","",3,"click"],["aria-label","add"],["aria-label","refresh"],[3,"data","columns","loading","multiSelectable","rowSelectable","showPaginator","toolbarTitle","rowStriped","showToolbar"],["isActiveTpl",""],["style","color:green;",4,"ngIf"],["style","color:red;",4,"ngIf"],[2,"color","green"],[2,"color","red"]],template:function(t,e){1&t&&(d.TgZ(0,"page-header"),d.TgZ(1,"button",0),d.NdJ("click",function(){return e.add()}),d.TgZ(2,"mat-icon",1),d._uU(3,"add"),d.qZA(),d.qZA(),d.TgZ(4,"button",0),d.NdJ("click",function(){return e.loadData()}),d.TgZ(5,"mat-icon",2),d._uU(6,"refresh"),d.qZA(),d.qZA(),d.qZA(),d._UZ(7,"mtx-grid",3),d.YNc(8,C,2,2,"ng-template",null,4,d.W1O)),2&t&&(d.xp6(7),d.Q6J("data",e.list)("columns",e.columns)("loading",e.isLoading)("multiSelectable",!0)("rowSelectable",!1)("showPaginator",!1)("toolbarTitle","Place list")("rowStriped",!0)("showToolbar",!1))},directives:[Y.q,A.lW,m.Hw,J.CM,g.O5],styles:[""]}),e}(),Q=o(81057);function S(t,e){1&t&&(d.TgZ(0,"mat-error"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"validations.required"),""))}function D(t,e){if(1&t&&(d.TgZ(0,"form",3),d.TgZ(1,"div",4),d.TgZ(2,"div",5),d.TgZ(3,"mat-form-field"),d.TgZ(4,"mat-label"),d._uU(5),d.ALo(6,"translate"),d.qZA(),d._UZ(7,"input",6),d.ALo(8,"translate"),d.YNc(9,S,3,3,"mat-error",2),d.qZA(),d.qZA(),d.TgZ(10,"div",5),d.TgZ(11,"mat-form-field"),d.TgZ(12,"mat-label"),d._uU(13),d.ALo(14,"translate"),d.qZA(),d._UZ(15,"mtx-select",7),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t){var i=d.oxw();d.Q6J("formGroup",i.form1),d.xp6(5),d.Oqu(d.lcZ(6,6,"common.ipaddress")),d.xp6(2),d.Q6J("placeholder",d.lcZ(8,8,"common.ipaddress")),d.xp6(2),d.Q6J("ngIf",i.form1.get("ipAddress").invalid),d.xp6(4),d.Oqu(d.lcZ(14,10,"bll.meter.type")),d.xp6(2),d.Q6J("items",i.types)}}function F(t,e){if(1&t){var i=d.EpF();d.TgZ(0,"mat-dialog-actions"),d.TgZ(1,"button",8),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"button",9),d.NdJ("click",function(){return d.CHM(i),d.oxw().save()}),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA()}if(2&t){var a=d.oxw();d.xp6(2),d.Oqu(d.lcZ(3,3,"common.close")),d.xp6(2),d.Q6J("disabled",a.form1.invalid),d.xp6(1),d.Oqu(d.lcZ(6,5,"common.save"))}}var j=function(){var e=function(){function e(i,a,o,n,l,s,r){t(this,e),this.dialogRef=i,this.toastr=a,this.fb=o,this.translate=n,this._classCodeService=l,this._api=s,this.data=r,this.types=l.getMeterType(),this.form1=this.fb.group({id:[null],typeId:[""],ipAddress:[""],deviceId:[""]}),this.form1.patchValue(this.data)}return i(e,[{key:"ngOnInit",value:function(){}},{key:"onClose",value:function(){this.dialogRef.close()}},{key:"save",value:function(){var t=this;console.log(this.data.id),this._api.datalog_save(this.data.id,this.form1.getRawValue()).subscribe(function(e){!0===e.successful&&t.toastr.success(e.message),t.dialogRef.close(!0)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(c.so),d.Y36(u._W),d.Y36(r.qu),d.Y36(p.sK),d.Y36(Q.I),d.Y36(f.t),d.Y36(c.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-extension-pvoutput-edit"]],decls:8,vars:6,consts:[["mat-dialog-title",""],["class","form-field-full",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"form-field-full",3,"formGroup"],["fxLayout","row wrap","fxLayoutGap","8px grid"],["fxFlex","50","fxFlex.lt-sm","100"],["matInput","","type","text","formControlName","ipAddress","required","",3,"placeholder"],["bindLabel","name","bindValue","key","formControlName","typeId",3,"items"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"disabled","click"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"mat-icon"),d._uU(2),d.qZA(),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"mat-dialog-content"),d.YNc(6,D,16,12,"form",1),d.qZA(),d.YNc(7,F,7,7,"mat-dialog-actions",2)),2&t&&(d.xp6(2),d.Oqu("00000000-0000-0000-0000-000000000000"!=e.data.id?"edit":"add"),d.xp6(1),d.hij(" ",d.lcZ(4,4,"00000000-0000-0000-0000-000000000000"!=e.data.id?"datalog.edit":"datalog.add")," "),d.xp6(3),d.Q6J("ngIf",null!=e.form1),d.xp6(1),d.Q6J("ngIf",e.form1))},directives:[c.uh,m.Hw,c.xY,g.O5,r._Y,r.JL,r.sg,h.xw,h.SQ,h.yH,Z.KE,Z.hX,x.Nt,r.Fj,r.JJ,r.u,r.Q7,v.MS,Z.TO,c.H8,A.lW,c.ZT],pipes:[p.X$],styles:[".mat-dialog-content[_ngcontent-%COMP%]{overflow:auto;max-height:none;display:inherit}"]}),e}(),G=["isActiveTpl"];function H(t,e){1&t&&(d.TgZ(0,"mat-icon",7),d._uU(1,"check"),d.qZA())}function M(t,e){1&t&&(d.TgZ(0,"mat-icon",8),d._uU(1,"close"),d.qZA())}function W(t,e){if(1&t&&(d.YNc(0,H,2,0,"mat-icon",5),d.YNc(1,M,2,0,"mat-icon",6)),2&t){var i=e.$implicit;d.Q6J("ngIf",1==i.isActive),d.xp6(1),d.Q6J("ngIf",0==i.isActive)}}var E,K,P=[{path:"pvoutput",component:N},{path:"datalog",component:(E=function(){function e(i,a,o,n,l,s){t(this,e),this.toastr=i,this.cdr=a,this._api=o,this.dialog=n,this._translate=l,this._router=s,this.columns=[],this.list=[],this.isLoading=!1}return i(e,[{key:"ngOnInit",value:function(){var t=this;this.columns=[{header:this._translate.stream("common.ipaddress"),field:"ipAddress",sortable:!0},{header:this._translate.stream("bll.meter.type"),field:"typeId",sortable:!0,formatter:function(e){return t._translate.instant("bll.meter.type"+e.typeId)}},{header:this._translate.stream("common.addtime"),field:"addTime",sortable:!0,formatter:function(t){return new Date(t.addTime).toLocaleString()}},{header:this._translate.stream("common.operation"),field:"option",width:"180px",pinned:"right",right:"0px",type:"button",buttons:[{icon:"pageview",tooltip:"View",type:"icon",click:function(t){return window.open("/vue/#/datalog/"+t.ipAddress)}},{icon:"edit",tooltip:"Edit",type:"icon",click:function(e){return t.edit(e)}},{icon:"delete",tooltip:"Delete",color:"warn",type:"icon",pop:!0,popTitle:"Confirm delete?",click:function(e){return t.delete(e)}}]}],this.loadData()}},{key:"loadData",value:function(){var t=this;this.isLoading=!0,this._api.datalog_list().subscribe(function(e){t.list=e.data,t.isLoading=!1,t.cdr.markForCheck(),t.cdr.detectChanges()})}},{key:"edit",value:function(t){this.openDialog(t)}},{key:"openDialog",value:function(t){var e=this;this.dialog.originalOpen(j,{width:"600px",data:t}).afterClosed().subscribe(function(t){!0===t&&e.loadData()})}},{key:"add",value:function(){this.openDialog({id:s.i.createEmpty(),typeId:1})}},{key:"delete",value:function(t){var e=this;this._api.datalog_delete(t.id).subscribe(function(t){!0===t.successful&&e.toastr.success(t.message),e.loadData()})}}]),e}(),E.\u0275fac=function(t){return new(t||E)(d.Y36(u._W),d.Y36(d.sBO),d.Y36(f.t),d.Y36(I.cP),d.Y36(p.sK),d.Y36(l.F0))},E.\u0275cmp=d.Xpm({type:E,selectors:[["app-extension-data"]],viewQuery:function(t,e){var i;1&t&&d.Gf(G,7),2&t&&d.iGM(i=d.CRH())&&(e.isActiveTpl=i.first)},decls:10,vars:9,consts:[["mat-button","",3,"click"],["aria-label","add"],["aria-label","refresh"],[3,"data","columns","loading","multiSelectable","rowSelectable","showPaginator","toolbarTitle","rowStriped","showToolbar"],["isActiveTpl",""],["style","color:green;",4,"ngIf"],["style","color:red;",4,"ngIf"],[2,"color","green"],[2,"color","red"]],template:function(t,e){1&t&&(d.TgZ(0,"page-header"),d.TgZ(1,"button",0),d.NdJ("click",function(){return e.add()}),d.TgZ(2,"mat-icon",1),d._uU(3,"add"),d.qZA(),d.qZA(),d.TgZ(4,"button",0),d.NdJ("click",function(){return e.loadData()}),d.TgZ(5,"mat-icon",2),d._uU(6,"refresh"),d.qZA(),d.qZA(),d.qZA(),d._UZ(7,"mtx-grid",3),d.YNc(8,W,2,2,"ng-template",null,4,d.W1O)),2&t&&(d.xp6(7),d.Q6J("data",e.list)("columns",e.columns)("loading",e.isLoading)("multiSelectable",!0)("rowSelectable",!1)("showPaginator",!1)("toolbarTitle","list")("rowStriped",!0)("showToolbar",!1))},directives:[Y.q,A.lW,m.Hw,J.CM,g.O5],styles:[""]}),E)}],R=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[l.Bz.forChild(P)],l.Bz]}),e}(),V=((K=function e(){t(this,e)}).\u0275fac=function(t){return new(t||K)},K.\u0275mod=d.oAB({type:K}),K.\u0275inj=d.cJS({imports:[[n.m,R]]}),K)}}])}();